{
  "name": "oauth",
  "label": "OAuth Package",
  "dependencies": [
    {
      "type": "service",
      "name": "http",
      "version": "v1.1.5",
      "instanceId": "shared"
    }
  ],
  "configuration": [
    {
      "label": "Auth URL",
      "name": "authUrl",
      "type": "text"
    },
    {
      "label": "Access Token URL",
      "name": "accessTokenUrl",
      "type": "text"
    },
    {
      "label": "Client Id",
      "name": "clientId",
      "type": "text"
    },
    {
      "label": "Client Secret",
      "name": "clientSecret",
      "type": "text"
    },
    {
      "label": "Scope",
      "name": "scope",
      "type": "text"
    },
    {
      "label": "State",
      "name": "state",
      "type": "text"
    },
    {
      "name": "requestToken",
      "label": "Request token",
      "type": "oauth2",
      "typeOptions": {
        "clientId": "config.clientId",
        "clientSecret": "config.clientSecret",
        "authUrl": "config.authUrl",
        "accessTokenUrl": "config.accessTokenUrl",
        "scope": "config.scope",
        "grantType": "'authorization_code'",
        "accessToken": "@config.accessToken",
        "refreshToken": "@config.refreshToken"
      }
    },
    {
      "label": "Callback URL",
      "name": "callbackUrl",
      "description": "The OAuth callback to configure in your GitHub App",
      "type": "label",
      "value": "@config.WEBHOOK_URL+'/authCallback'"
    },
    {
      "name": "accessToken",
      "label": "Access token",
      "type": "text"
    },
    {
      "name": "refreshToken",
      "label": "Refresh token",
      "type": "text"
    }
  ],
  "events": [
    {
      "label": "Webhook",
      "name": "webhook",
      "description": "Happens when SharePoint sends a webhook to the endpoint."
    }
  ],
  "metadata": [
    {
      "type": "script",
      "namespace": "api",
      "path": "/scripts/functions.js"
    },
    {
      "type": "uiService",
      "namespace": "oAuth",
      "path": "/uiServices/oAuth"
    }
  ]
}